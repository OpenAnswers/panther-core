<!DOCTYPE html>

<html>
<head>
  <title>errors.coffee</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="errors.html">
                  errors.coffee
                </a>
              
                
                <a class="source" href="helpers.html">
                  helpers.coffee
                </a>
              
                
                <a class="source" href="index.html">
                  index.coffee
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>errors.coffee</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h2 id="error">Error</h2>

            </div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>This containers all the standard error sub classes we use.</p>

            </div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>All classes are exported on @ (this) so that both Node and Front end can
use the classes once the file has been included.</p>

            </div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>ValidationError is the most used, It probably needs subclassing itself.</p>

            </div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <h3 id="socketerror">SocketError</h3>
<p>Errors that occur on socketio itself</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SocketError</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span></span>
  name: <span class="hljs-string">&#x27;SocketError&#x27;</span>
  constructor: <span class="hljs-function"><span class="hljs-params">(@message, options)</span>-&gt;</span>
    <span class="hljs-built_in">Error</span>.captureStackTrace(<span class="hljs-built_in">this</span>, SocketError) <span class="hljs-keyword">if</span> <span class="hljs-built_in">Error</span>.captureStackTrace
    @name = <span class="hljs-string">&#x27;SocketError&#x27;</span>
@SocketError = SocketError</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <h3 id="socketmsgerror">SocketMsgError</h3>
<p>Error that occur on the messages to/form socketio clients</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SocketMsgError</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span></span>
  name: <span class="hljs-string">&#x27;SocketMsgError&#x27;</span>
  constructor: <span class="hljs-function"><span class="hljs-params">(@message,options = {} )</span>-&gt;</span>
    <span class="hljs-built_in">Error</span>.captureStackTrace(<span class="hljs-built_in">this</span>, SocketMsgError) <span class="hljs-keyword">if</span> <span class="hljs-built_in">Error</span>.captureStackTrace
    @name = <span class="hljs-string">&#x27;SocketMsgError&#x27;</span>
@SocketMsgError = SocketMsgError</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <h3 id="queryerror">QueryError</h3>
<p>For any problems with the result of a db/data query
Mongoose/Mongodb query errors should be wrapped into this class when thrown.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">QueryError</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span></span>
  name: <span class="hljs-string">&#x27;QueryError&#x27;</span>
  constructor: <span class="hljs-function"><span class="hljs-params">(@message, options = {} )</span>-&gt;</span>
    <span class="hljs-built_in">Error</span>.captureStackTrace(<span class="hljs-built_in">this</span>, QueryError) <span class="hljs-keyword">if</span> <span class="hljs-built_in">Error</span>.captureStackTrace
    @name = <span class="hljs-string">&#x27;QueryError&#x27;</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> options
    @code = options.code <span class="hljs-keyword">if</span> options.code?
    @field = options.field <span class="hljs-keyword">if</span> options.field?
    @value = options.value <span class="hljs-keyword">if</span> options.value?
    @query = options.query <span class="hljs-keyword">if</span> options.query?
    @status = options.status <span class="hljs-keyword">if</span> options.status?
    @simple = options.simple <span class="hljs-keyword">if</span> options.simple?
@QueryError = QueryError


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NotFoundError</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span></span>
  name: <span class="hljs-string">&#x27;NotFoundError&#x27;</span>
  constructor: <span class="hljs-function"><span class="hljs-params">(@message, options = {} )</span>-&gt;</span>
    <span class="hljs-built_in">Error</span>.captureStackTrace(<span class="hljs-built_in">this</span>, NotFoundError) <span class="hljs-keyword">if</span> <span class="hljs-built_in">Error</span>.captureStackTrace
    @name = <span class="hljs-string">&#x27;NotFoundError&#x27;</span>
    @status = <span class="hljs-number">404</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> options</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>A custom code for the error</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    @code = options.code <span class="hljs-keyword">if</span> options.code?</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>The field that was in error</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    @field = options.field <span class="hljs-keyword">if</span> options.field?</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>The value that was in error</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    @value = options.value <span class="hljs-keyword">if</span> options.value?</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>in case this is a http request</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    @status = options.status <span class="hljs-keyword">if</span> options.status?
    @simple = options.simple <span class="hljs-keyword">if</span> options.simple?
@NotFoundError = NotFoundError</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <h3 id="validationerror">ValidationError</h3>

            </div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Any client based data validation error should be thrown with this.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ValidationError</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span></span>
  name: <span class="hljs-string">&#x27;ValidationError&#x27;</span>
  constructor: <span class="hljs-function"><span class="hljs-params">(@message, options = {} )</span>-&gt;</span>
    <span class="hljs-built_in">Error</span>.captureStackTrace(<span class="hljs-built_in">this</span>, ValidationError) <span class="hljs-keyword">if</span> <span class="hljs-built_in">Error</span>.captureStackTrace
    @name = <span class="hljs-string">&#x27;ValidationError&#x27;</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> options</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>A custom type for the error</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    @type = options.type <span class="hljs-keyword">if</span> options.type?</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>A custom code for the error</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    @code = options.code <span class="hljs-keyword">if</span> options.code?</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>The field that was in error</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    @field = options.field <span class="hljs-keyword">if</span> options.field?</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>The value that was in error</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    @value = options.value <span class="hljs-keyword">if</span> options.value?</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>The format required for this field</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    @format = options.format <span class="hljs-keyword">if</span> options.format?</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>css id/selector for the field/value in question</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    @id = options.id <span class="hljs-keyword">if</span> options.id?</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>in case this is a http request</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    @status = options.status <span class="hljs-keyword">if</span> options.status?
    @simple = options.simple <span class="hljs-keyword">if</span> options.simple?</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Export it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>@ValidationError = ValidationError</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <h3 id="requesterror">RequestError</h3>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RequestError</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span></span>
  name: <span class="hljs-string">&#x27;RequestError&#x27;</span>
  constructor: <span class="hljs-function"><span class="hljs-params">( @message, options = {} )</span>-&gt;</span>
    <span class="hljs-built_in">Error</span>.captureStackTrace(<span class="hljs-built_in">this</span>, RequestError) <span class="hljs-keyword">if</span> <span class="hljs-built_in">Error</span>.captureStackTrace
    <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">of</span> options
      @[key] = value
    @name = <span class="hljs-string">&#x27;RequestError&#x27;</span>

@RequestError = RequestError</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <h3 id="badrequesterror">BadRequestError</h3>

            </div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Error from passport-local-mongoose
Reuse for other requesty type things</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BadRequestError</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span></span>
  name: <span class="hljs-string">&#x27;BadRequestError&#x27;</span>
  constructor: <span class="hljs-function"><span class="hljs-params">(@message, options = {} )</span>-&gt;</span>
    <span class="hljs-built_in">Error</span>.captureStackTrace(<span class="hljs-built_in">this</span>, BadRequestError) <span class="hljs-keyword">if</span> <span class="hljs-built_in">Error</span>.captureStackTrace
    @name = <span class="hljs-string">&#x27;BadRequestError&#x27;</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> options
    @simple = options.simple <span class="hljs-keyword">if</span> options.simple?</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Export</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>@BadRequestError = BadRequestError</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <h3 id="notimplementederror">NotImplementedError</h3>

            </div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>For base class methods that should be inherited.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NotImplementedError</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span></span>
  name: <span class="hljs-string">&#x27;NotImplementedError&#x27;</span>
  constructor: <span class="hljs-function"><span class="hljs-params">(@message, options = {} )</span>-&gt;</span>
    <span class="hljs-built_in">Error</span>.captureStackTrace(<span class="hljs-built_in">this</span>, NotImplementedError) <span class="hljs-keyword">if</span> <span class="hljs-built_in">Error</span>.captureStackTrace
    @name = <span class="hljs-string">&#x27;NotImplementedError&#x27;</span></pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Export</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>@NotImplementedError = NotImplementedError</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <h3 id="certificateerror">CertificateError</h3>

            </div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>Any client based error when sending emails, which is not really important</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CertificateError</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span></span>
  name: <span class="hljs-string">&#x27;CertificateError&#x27;</span>
  constructor: <span class="hljs-function"><span class="hljs-params">(@message, options = {} )</span>-&gt;</span>
    <span class="hljs-built_in">Error</span>.captureStackTrace(<span class="hljs-built_in">this</span>, CertificateError) <span class="hljs-keyword">if</span> <span class="hljs-built_in">Error</span>.captureStackTrace</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>Export</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>@CertificateError = CertificateError</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <h3 id="emailerror">EmailError</h3>

            </div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>Any client based error when sending emails, which is not really important</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EmailError</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span></span>
  name: <span class="hljs-string">&#x27;EmailError&#x27;</span>
  constructor: <span class="hljs-function"><span class="hljs-params">(@message, options = {} )</span>-&gt;</span>
    <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">of</span> options
      @[key] = value
    <span class="hljs-built_in">Error</span>.captureStackTrace(<span class="hljs-built_in">this</span>, EmailError) <span class="hljs-keyword">if</span> <span class="hljs-built_in">Error</span>.captureStackTrace
    @name = <span class="hljs-string">&#x27;EmailError&#x27;</span>
@EmailError = EmailError</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <h3 id="httperrors-for-express">HttpErrors for express</h3>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HttpError</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span></span>
  name: <span class="hljs-string">&#x27;HttpError&#x27;</span>
  constructor: <span class="hljs-function"><span class="hljs-params">(@message,options = {} )</span>-&gt;</span>
    <span class="hljs-built_in">Error</span>.captureStackTrace(<span class="hljs-built_in">this</span>, HttpError) <span class="hljs-keyword">if</span> <span class="hljs-built_in">Error</span>.captureStackTrace
    @name = <span class="hljs-string">&#x27;HttpError&#x27;</span>
    @code = options.code
    @status = @code</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>Export</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>@HttpError = HttpError</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>The HTTP error classes should be able to built from a config
codes = [
400: { message: “Bad Request” }
401: { message: “Authorization failed” }
404: { message: “Not found” }
500: { message: “Server Error” }
]
for code,info of codes
create HttpError#{code} </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-class"><span class="hljs-keyword">class</span> @<span class="hljs-title">HttpError404</span> <span class="hljs-keyword">extends</span> @<span class="hljs-title">HttpError</span></span>
  name: <span class="hljs-string">&#x27;HttpError404&#x27;</span>
  constructor: <span class="hljs-function"><span class="hljs-params">( @detail, options = {} )</span>-&gt;</span>
    <span class="hljs-built_in">Error</span>.captureStackTrace(<span class="hljs-built_in">this</span>, HttpError404) <span class="hljs-keyword">if</span> <span class="hljs-built_in">Error</span>.captureStackTrace
    @code = <span class="hljs-number">404</span>
    @status = @code
    @message = <span class="hljs-string">&quot;Not Found&quot;</span>
    @message += <span class="hljs-string">&quot; <span class="hljs-subst">#{@detail}</span>&quot;</span> <span class="hljs-keyword">if</span> @detail
    @simple = options.simple <span class="hljs-keyword">if</span> options?.simple

<span class="hljs-class"><span class="hljs-keyword">class</span> @<span class="hljs-title">HttpError400</span> <span class="hljs-keyword">extends</span> @<span class="hljs-title">HttpError</span></span>
  name: <span class="hljs-string">&#x27;HttpError400&#x27;</span>
  constructor: <span class="hljs-function"><span class="hljs-params">( @detail, options = {} )</span>-&gt;</span>
    <span class="hljs-built_in">Error</span>.captureStackTrace(<span class="hljs-built_in">this</span>, HttpError400) <span class="hljs-keyword">if</span> <span class="hljs-built_in">Error</span>.captureStackTrace
    @code = <span class="hljs-number">400</span>
    @status = @code
    @message = <span class="hljs-string">&quot;Bad Request&quot;</span>
    @message += <span class="hljs-string">&quot; <span class="hljs-subst">#{@detail}</span>&quot;</span> <span class="hljs-keyword">if</span> @detail
    @simple = options.simple <span class="hljs-keyword">if</span> options?.simple

<span class="hljs-class"><span class="hljs-keyword">class</span> @<span class="hljs-title">HttpError401</span> <span class="hljs-keyword">extends</span> @<span class="hljs-title">HttpError</span></span>
  name: <span class="hljs-string">&#x27;HttpError401&#x27;</span>
  constructor: <span class="hljs-function"><span class="hljs-params">( @detail, options = {} )</span>-&gt;</span>
    <span class="hljs-built_in">Error</span>.captureStackTrace(<span class="hljs-built_in">this</span>, HttpError401) <span class="hljs-keyword">if</span> <span class="hljs-built_in">Error</span>.captureStackTrace
    @code = <span class="hljs-number">401</span>
    @status = @code
    @message = <span class="hljs-string">&quot;Unauthorised&quot;</span>
    @message += <span class="hljs-string">&quot; <span class="hljs-subst">#{@detail}</span>&quot;</span> <span class="hljs-keyword">if</span> @detail
    @simple = options.simple <span class="hljs-keyword">if</span> options?.simple

<span class="hljs-class"><span class="hljs-keyword">class</span> @<span class="hljs-title">HttpError500</span> <span class="hljs-keyword">extends</span> @<span class="hljs-title">HttpError</span></span>
  name: <span class="hljs-string">&#x27;HttpError500&#x27;</span>
  constructor: <span class="hljs-function"><span class="hljs-params">( @detail, options = {} )</span>-&gt;</span>
    <span class="hljs-built_in">Error</span>.captureStackTrace(<span class="hljs-built_in">this</span>, HttpError500) <span class="hljs-keyword">if</span> <span class="hljs-built_in">Error</span>.captureStackTrace
    @code = <span class="hljs-number">500</span>
    @status = @code
    @message = <span class="hljs-string">&quot;Server Error&quot;</span>
    @message += <span class="hljs-string">&quot; <span class="hljs-subst">#{@detail}</span>&quot;</span> <span class="hljs-keyword">if</span> @detail
    @simple = options.simple <span class="hljs-keyword">if</span> options?.simple



<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ErrorGroup</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span></span>
  name: <span class="hljs-string">&#x27;ErrorGroup&#x27;</span>

  constructor: <span class="hljs-function"><span class="hljs-params">( @message, @options = {} )</span>-&gt;</span>
    <span class="hljs-built_in">Error</span>.captureStackTrace(<span class="hljs-built_in">this</span>, ErrorGroup) <span class="hljs-keyword">if</span> <span class="hljs-built_in">Error</span>.captureStackTrace
    @name = <span class="hljs-string">&#x27;ErrorGroup&#x27;</span>
    @message = <span class="hljs-string">&quot;<span class="hljs-subst">#{@message}</span>&quot;</span>
    @errors = []
    @default_type = <span class="hljs-built_in">Error</span>

  count: <span class="hljs-function">-&gt;</span>
    @errors.length

  add: <span class="hljs-function"><span class="hljs-params">( error )</span>-&gt;</span>
    @errors.push error
    @message += <span class="hljs-string">&quot;: <span class="hljs-subst">#{error.message}</span>&quot;</span>

  add_new: <span class="hljs-function"><span class="hljs-params">( error_type, message, options = {} )</span>-&gt;</span>
    <span class="hljs-keyword">if</span> error_type <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Error</span>
      error_cls = error_type
    <span class="hljs-keyword">else</span>
      error_cls = ErrorType.lookup error_type
      <span class="hljs-keyword">unless</span> error_cls
        error_cls = @default_type
    @add <span class="hljs-keyword">new</span> error_cls( message, options )

  throw_if_errors: <span class="hljs-function">-&gt;</span>
    <span class="hljs-keyword">if</span> @errors.length &gt; <span class="hljs-number">0</span>
      <span class="hljs-keyword">throw</span> @

@ErrorGroup = ErrorGroup


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ValidationGroup</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ErrorGroup</span></span>
  name: <span class="hljs-string">&#x27;ValidationGroup&#x27;</span>
  default_type = ValidationError
  constructor: <span class="hljs-function"><span class="hljs-params">( @message, @options = {} )</span>-&gt;</span>
    <span class="hljs-built_in">super</span>
    @name = <span class="hljs-string">&#x27;ValidationGroup&#x27;</span>
    @default_type = ValidationError

@ValidationGroup = ValidationGroup</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <h2 id="errortype">ErrorType</h2>

            </div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>When errors are serialised to JSON they become plain objects but retain
the error metadata. This coverts them back to the real errors. </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ErrorType</span></span></pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>We need a lookup to the local exported classes in ErrorType</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
  @types =
    <span class="hljs-string">&#x27;SocketError&#x27;</span>:      SocketError
    <span class="hljs-string">&#x27;Socket&#x27;</span>:           SocketError
    <span class="hljs-string">&#x27;SocketMsgError&#x27;</span>:   SocketMsgError
    <span class="hljs-string">&#x27;SocketMsg&#x27;</span>:        SocketMsgError
    <span class="hljs-string">&#x27;HttpError&#x27;</span>:        HttpError
    <span class="hljs-string">&#x27;Http&#x27;</span>:             HttpError
    <span class="hljs-string">&#x27;ValidationError&#x27;</span>:  ValidationError
    <span class="hljs-string">&#x27;Validation&#x27;</span>:       ValidationError
    <span class="hljs-string">&#x27;RequestError&#x27;</span>:     RequestError
    <span class="hljs-string">&#x27;Request&#x27;</span>:          RequestError
    <span class="hljs-string">&#x27;BadRequestError&#x27;</span>:  BadRequestError
    <span class="hljs-string">&#x27;BadRequest&#x27;</span>:       BadRequestError
    <span class="hljs-string">&#x27;NotFoundError&#x27;</span>:    NotFoundError
    <span class="hljs-string">&#x27;NotFound&#x27;</span>:         NotFoundError
    <span class="hljs-string">&#x27;QueryError&#x27;</span>:       QueryError
    <span class="hljs-string">&#x27;Query&#x27;</span>:            QueryError

    <span class="hljs-string">&#x27;ErrorGroup&#x27;</span>:       ErrorGroup
    <span class="hljs-string">&#x27;ValidationGroup&#x27;</span>:  ValidationGroup</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>Error type lookup from String   </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  @lookup = <span class="hljs-function"><span class="hljs-params">( name )</span>-&gt;</span>
    @types[name]</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>Json serialises errors as plain objects.
Convert them back so things like bluebird
can use them without complaining</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  @from_object = <span class="hljs-function"><span class="hljs-params">( error_var )</span>-&gt;</span></pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>Our new error </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    error = <span class="hljs-literal">null</span></pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>Check if we have serialised error</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span> error_var <span class="hljs-keyword">is</span> <span class="hljs-string">&#x27;object&#x27;</span> <span class="hljs-keyword">and</span> error_var.message <span class="hljs-keyword">isnt</span> <span class="hljs-literal">undefined</span></pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>Check if we have a known error type</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> customer_error_type = @lookup error_var.name
        error = <span class="hljs-keyword">new</span> customer_error_type error_var.message
      <span class="hljs-keyword">else</span>
        error = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span> error_var.message</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>Attach any other properties</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">of</span> error_var
        error[key] = value</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>Generate something if the json doesn’t look like an error</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">else</span>
      error = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span> error_var

    error

@ErrorType = ErrorType</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
